<div id="user" flex layout="column" layout-fill layout-align="start stretch">
	<span ng-if="!firebase.isSignedIn">You must me authenticated to access user controls</span>
	<span ng-if="firebase.isSignedIn" layout="column" layout-align="start stretch">
		<span ng-if="instructions">{{ instructions }}</span>
		<form ng-cloak accept-charset="UTF-8" name="profileForm" layout="column" layout-align="start stretch">
			<span layout="row" layout-wrap layout-align="center center">
				<md-input-container>
					<md-icon class="fa fa-paper-plane amber-text hover-pointer" ng-if="!currentUser.emailVerified" title="your email is not verified, click here to request a verification link" ng-click="resendVerificationEmail()"></md-icon>
					<md-icon class="fa fa-check green-text" ng-if="currentUser.emailVerified" title="your email is verified"></md-icon>
					<input type="email" name="email" ng-model="profile.email" ng-pattern="patterns.email" placeholder="your_email@domain.tld" ng-disabled="!mode.edit || !mode.updateEmail" required>
					<md-icon class="fa fa-envelope"></md-icon>
					<div ng-messages="profileForm.email.$error">
						<div ng-message="required">This field is required</div>
						<div ng-message="pattern">Invalid value, it should be an email</div>
					</div>
				</md-input-container>
				<md-input-container>
					<input type="text" name="name" ng-model="profile.name" placeholder="your display name" ng-disabled="!mode.edit">
					<md-icon class="fa fa-user-circle-o"></md-icon>
				</md-input-container>
			</span>
			<span layout="row" layout-wrap layout-align="center center">
				<md-button ng-if="!mode.edit" ng-click="resetPassword()" aria-label="reset password">reset password</md-button>
				<md-button ng-click="toggleEditMode()" aria-label="toggle edit mode">
					<span ng-if="!mode.edit">edit profile</span>
					<span ng-if="mode.edit">cancel</span>
				</md-button>
				<md-button type="submit" ng-if="mode.edit" ng-disabled="profileForm.$invalid" ng-click="updateProfile(profileForm.$valid)" aria-label="update profile">update</md-button>
				<md-button type="submit" ng-if="mode.edit" ng-disabled="!profile.password.trim()" ng-disabled="profileForm.$invalid" ng-click="deleteProfile($event)" aria-label="delete profile" class="md-warn">delete</md-button>
				<md-input-container flex="40" ng-if="mode.edit">
					<input type="{{showPassword ? 'text' : 'password' }}" name="password" ng-model="profile.password" placeholder="provide a password to DELETE your account">
					<md-icon class="visibility-toggler fa fa-eye" ng-if="!showPassword" ng-click="togglePasswordVisibility()"></md-icon>
					<md-icon class="visibility-toggler fa fa-eye-slash" ng-if="showPassword" ng-click="togglePasswordVisibility()"></md-icon>
				</md-input-container>
				<md-button ng-if="!mode.edit && !SCdata.me" class="amber-text" ng-click="scConnect()" aria-label="connect with Soundcloud">connect with soundcloud</md-button>
				<md-button ng-if="!mode.edit && SCdata.me" class="green-text" ng-click="scConnect()" aria-label="reconnect with Soundcloud or connect another account">reconnect with soundcloud or connect another account</md-button>
			</span>
		</form>
	</span>
	<span flex layout="row" layout-wrap layout-align="start stretch" ng-if="firebase.isSignedIn && SCdata.me">
		<span id="soundcloud-user" flex="20" flex-xs="100" flex-sm="100" layout="column" layout-align="start stretch" ng-if="SCdata.me">
			<span class="md-body-1">{{ SCdata.me.username }}</span>
			<span class="md-body-1">{{ SCdata.me.full_name }}</span>
			<span class="md-body-2">Playlists: {{ SCdata.me.playlist_count }}</span>
			<span flex="grow" class="md-body-1" ng-bind-html="SCdata.me.description"></span>
		</span>
		<span id="soundcloud-playlists" flex="80" flex-xs="100" flex-sm="100" layout="column" layout-align="start stretch" ng-if="SCdata.playlists">
			<md-grid-list flex="100" md-cols-xs="1" md-cols-sm="2" md-cols-md="3" md-cols-lg="4" md-cols-xl="5" md-gutter="10px" md-row-height="2:3">
				<md-grid-tile ng-repeat="playlist in SCdata.playlists">
					<md-grid-tile-header class="md-body-2">
						{{ playlist.title }}
					</md-grid-tile-header>
					<iframe ng-src="{{widgetLink(playlist.id)}}" width="100%" height="85%" scrolling="no" frameborder="no"></iframe>
					<md-grid-tile-footer>
						<md-button>add to blog</md-button>
					</md-grid-tile-footer>
				</md-grid-tile>
			</md-grid-list>
		</span>
	</span>
</div>
